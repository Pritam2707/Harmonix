apply plugin: "com.android.application"
apply plugin: "org.jetbrains.kotlin.android"
apply plugin: "com.facebook.react"
apply plugin: "com.chaquo.python"

react {
    autolinkLibrariesWithApp()
}

def enableProguardInReleaseBuilds = false
def jscFlavor = 'io.github.react-native-community:jsc-android:2026004.+'

android {
    namespace "com.harmonix"
    compileSdk rootProject.ext.compileSdkVersion
    buildToolsVersion rootProject.ext.buildToolsVersion
    ndkVersion rootProject.ext.ndkVersion
    defaultConfig {
        applicationId "com.harmonix"
        minSdkVersion rootProject.ext.minSdkVersion
        targetSdkVersion rootProject.ext.targetSdkVersion
        versionCode = 5
        versionName = "1.0.5"
        ndk {
              abiFilters "arm64-v8a"
        }

      python {
        version = "3.10"
        buildPython "C:\\Users\\Pritam\\.pyenv\\pyenv-win\\versions\\3.10.0\\python.exe"
    
        pip {
            install "ytmusicapi>=1.10.0"
            install "yt-dlp" 
            install "requests" 
            install "urllib3" 
        }
    
        // staticStdlib true
        // pyc {
        // optimize = 2  // equivalent to `python -OO`, strips docstrings
        // src = false   // donâ€™t include .py source files in the APK
        // }
    }
    }

 signingConfigs {
        release {
            storeFile file(MYAPP_RELEASE_STORE_FILE)
            storePassword MYAPP_RELEASE_STORE_PASSWORD
            keyAlias MYAPP_RELEASE_KEY_ALIAS
            keyPassword MYAPP_RELEASE_KEY_PASSWORD
        }
    }

    buildTypes {
        release {
            signingConfig signingConfigs.release
            minifyEnabled false
            shrinkResources false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    packagingOptions {
        exclude "lib/armeabi/**"
        exclude "lib/x86/**"
    }
}

dependencies {
    implementation("androidx.browser:browser") {
        version {
            strictly("1.8.0")
        }
    }
    implementation 'androidx.media:media:1.2.1'
    implementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3"
    implementation "com.facebook.react:react-android"
    implementation 'androidx.core:core-splashscreen:1.0.1'

    if (hermesEnabled.toBoolean()) {
        implementation "com.facebook.react:hermes-android"
    } else {
        implementation jscFlavor
    }
}
